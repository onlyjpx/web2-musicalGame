datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Usuario {
  id         Int         @id @default(autoincrement())
  nome       String
  email      String      @unique
  senha      String?      
  tipo       String      // "admin" ou "usuario"
  provider   String      @default("local")
  picture    String      @default("https://cdn-icons-png.flaticon.com/512/17/17004.png")
  tentativas Tentativa[]
}

model Desafio {
  id          Int              @id @default(autoincrement())
  titulo      String
  genero      String
  dificuldade Dificuldade
  tentativas  Tentativa[]
  musicas     DesafioMusica[]
}

model Tentativa {
  id            Int      @id @default(autoincrement())
  usuarioId     Int
  desafioId     Int
  acertou       Boolean
  tempoResposta Float?   
  pontos        Int
  usuario       Usuario  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  desafio       Desafio  @relation(fields: [desafioId], references: [id], onDelete: Cascade)
}

model DesafioMusica {
  id         Int     @id @default(autoincrement())
  desafioId  Int
  deezerId   String
  desafio    Desafio @relation(fields: [desafioId], references: [id], onDelete: Cascade)

  @@unique([desafioId, deezerId])
}

enum Dificuldade {
  FACIL
  MEDIO
  DIFICIL
  MUITO_DIFICIL
  EXTREMO
}
